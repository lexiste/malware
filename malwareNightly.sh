#!/usr/bin/env bash

cd ~/pastebins/archive/

for i in $(find . -maxdepth 1 -type d)
do
   if [ "$i" != "." ]; then
      echo "compressing $i --> $i.tar.xz"
      tar cJf ~/pastebins/archive/$i.tar.xz $i

      # if the tar command completed, remove files in folder
      test $? -eq 0 && rm -f ~/pastebins/archive/$i/*
      # if removed files, remove folder
      test $? -eq 0 && rmdir ~/pastebins/archive/$i
   else
      echo "skipping self directory ($i)"
   fi
done 
